import{d as k,j as b,k as E,o as r,c as _,n as S,f as i,g as I,p as A,l as T,e as y,m as Y,q as j,s as h,v as x,w as P,F as q,x as Q,u as R,a as L,y as J,t as f,b as H}from"./app-9785f1b5.js";import{u as D}from"./user-59cc8e10.js";const O=k({__name:"FakeJugNode",props:{cell:null},emits:["hover","click"],setup(e,{emit:o}){const t=b(0);return E(()=>{t.value=Math.floor(Math.random()*180)}),(l,n)=>(r(),_("div",{class:"fake-jug-cell",onMouseover:n[0]||(n[0]=a=>l.$emit("hover")),style:S(`transform: rotate(${i(t)}deg)`),onClick:n[1]||(n[1]=a=>l.$emit("click"))},null,36))}});const U=I(O,[["__scopeId","data-v-40928dd2"]]),K=k({__name:"JugNode",props:{cell:null},emits:["hover","click"],setup(e,{emit:o}){const t=b(0);return E(()=>{t.value=Math.floor(Math.random()*180)}),(l,n)=>(r(),_("div",{class:"jug-cell",onMouseover:n[0]||(n[0]=a=>l.$emit("hover")),style:S(`transform: rotate(${i(t)}deg)`),onClick:n[1]||(n[1]=a=>l.$emit("click"))},null,36))}});const Z=I(K,[["__scopeId","data-v-5291b6f5"]]),ee=e=>(A("data-v-959980e5"),e=e(),T(),e),te=ee(()=>y("img",{class:"rock",src:"https://www.svgrepo.com/download/407352/rock.svg",alt:""},null,-1)),le=[te],oe=k({__name:"FakeWallNode",props:{cell:null},emits:["hover","click"],setup(e,{emit:o}){return(t,l)=>(r(),_("div",{class:"fake-wall-cell",onMouseover:l[0]||(l[0]=n=>t.$emit("hover")),onClick:l[1]||(l[1]=n=>t.$emit("click"))},le,32))}});const ne=I(oe,[["__scopeId","data-v-959980e5"]]),ae=k({__name:"PlayerNode",props:{cell:null},emits:["hover","click"],setup(e,{emit:o}){return(t,l)=>(r(),_("div",{class:"player-cell",onMouseover:l[0]||(l[0]=n=>t.$emit("hover")),onClick:l[1]||(l[1]=n=>t.$emit("click"))},[y("div",{class:Y(["frog",{isActive:e.cell.data.isActive}])},null,2)],32))}});const se=I(ae,[["__scopeId","data-v-4eabdccf"]]),re=e=>(A("data-v-623cdaa6"),e=e(),T(),e),ie=re(()=>y("img",{class:"rock",src:"https://www.svgrepo.com/download/407352/rock.svg",alt:""},null,-1)),ce=[ie],ue=k({__name:"WallNode",props:{cell:null},emits:["hover","click"],setup(e,{emit:o}){return(t,l)=>(r(),_("div",{class:"wall-cell",onMouseover:l[0]||(l[0]=n=>t.$emit("hover")),onClick:l[1]||(l[1]=n=>t.$emit("click"))},ce,32))}});const de=I(ue,[["__scopeId","data-v-623cdaa6"]]),pe=k({__name:"EmptyNode",props:{cell:null},emits:["hover","click"],setup(e,{emit:o}){return(t,l)=>(r(),_("div",{class:"empty-cell",onMouseover:l[0]||(l[0]=n=>t.$emit("hover"))},null,32))}});const ve=I(pe,[["__scopeId","data-v-7e498ccb"]]),ye={class:"cell"},me={style:{position:"absolute"}},_e=k({__name:"Cell",props:{cell:null},emits:["hover","click"],setup(e,{emit:o}){return(t,l)=>{var N,s,p,C,$,g;const n=ve,a=de,c=se,m=ne,u=Z,d=U;return r(),_("div",ye,[y("div",me,[j(t.$slots,"default")]),((N=e.cell)==null?void 0:N.type)==="empty"?(r(),h(n,{key:0,cell:e.cell,onHover:l[0]||(l[0]=v=>t.$emit("hover")),onClick:l[1]||(l[1]=v=>t.$emit("click"))},null,8,["cell"])):x("",!0),((s=e.cell)==null?void 0:s.type)==="wall"?(r(),h(a,{key:1,cell:e.cell,onHover:l[2]||(l[2]=v=>t.$emit("hover")),onClick:l[3]||(l[3]=v=>t.$emit("click"))},null,8,["cell"])):x("",!0),((p=e.cell)==null?void 0:p.type)==="player-node"?(r(),h(c,{key:2,cell:e.cell,onHover:l[4]||(l[4]=v=>t.$emit("hover")),onClick:l[5]||(l[5]=v=>t.$emit("click"))},null,8,["cell"])):x("",!0),((C=e.cell)==null?void 0:C.type)==="fake-wall"?(r(),h(m,{key:3,cell:e.cell,onHover:l[6]||(l[6]=v=>t.$emit("hover")),onClick:l[7]||(l[7]=v=>t.$emit("click"))},null,8,["cell"])):x("",!0),(($=e.cell)==null?void 0:$.type)==="node"?(r(),h(u,{key:4,cell:e.cell,onHover:l[8]||(l[8]=v=>t.$emit("hover")),onClick:l[9]||(l[9]=v=>t.$emit("click"))},null,8,["cell"])):x("",!0),((g=e.cell)==null?void 0:g.type)==="fake-node"?(r(),h(d,{key:5,cell:e.cell,onHover:l[10]||(l[10]=v=>t.$emit("hover")),onClick:l[11]||(l[11]=v=>t.$emit("click"))},null,8,["cell"])):x("",!0)])}}});function V(e=$e()){const o=b({board:fe(e),player1:z(e,e.player1),player2:z(e,e.player2),activePlayer:"player1"}),t=xe(o,e);return{state:o,gameBoard:t,actions:{hover:a=>ge({gameItem:a,state:o,config:e,gameBoard:t}),click:a=>he({gameItem:a,state:o,config:e,gameBoard:t})}}}function fe(e){return{nodes:ke(e),walls:Ne()??[],fakeWalls:[],fakeNodes:[]}}function ke(e){return[...Array(e.size.width)].flatMap((o,t)=>[...Array(e.size.height)].map((l,n)=>({x:t+1,y:n+1})))}function $e(){return{size:{width:9,height:9},player1:{name:"Player1",x:4,y:5},player2:{name:"Player2",x:8,y:5}}}function z(e,o){return{name:o.name,position:{x:o.x,y:o.y},walls:10}}function xe(e,o){return P(()=>{const t=2*o.size.width-1,l=2*o.size.height-1,n=[...Array(t*l)].map((s,p)=>({type:"empty",data:p,index:p})),{nodes:a,walls:c,fakeWalls:m,fakeNodes:u}=e.value.board;m.flatMap(s=>G(s,t)).forEach(s=>n[s.index]={type:"fake-wall",data:s.data,index:s.index}),a.forEach(s=>{const p=B(s,t);n[p]={type:"node",data:s,index:p}}),c.flatMap(s=>G(s,t)).forEach(s=>n[s.index]=s),u.forEach(s=>{const p=B(s,t);n[p]={type:"fake-node",data:s,index:p}});const d=B(e.value.player1.position,t),N=B(e.value.player2.position,t);return n[d]={type:"player-node",index:d,data:{player:e.value.player1,isActive:e.value.activePlayer==="player1"}},n[N]={type:"player-node",index:N,data:{player:e.value.player2,isActive:e.value.activePlayer==="player2"}},{items:n,fullGameWidth:t,fullGameHeight:l}})}function M(e){return{x:2*e.x-1,y:2*e.y-1}}function B(e,o){const{x:t,y:l}=M(e);return w({x:t,y:l},o)}function w({x:e,y:o},t){return 2*e+(t-e)+(o-2)*t-1}function W(e,o){return e<o?{min:e,max:o}:{min:o,max:e}}function Ne(){return[{type:"horizontal",topNode1:{x:1,y:1},topNode2:{x:2,y:1},bottomNode1:{x:1,y:2},bottomNode2:{x:2,y:2}},{type:"vertical",leftNode1:{x:5,y:1},leftNode2:{x:5,y:2},rightNode1:{x:6,y:1},rightNode2:{x:6,y:2}}]}function ge({gameItem:e,gameBoard:o,state:t}){const l=e.index;t.value.board.fakeWalls=[],(e.type==="empty"||e.type==="fake-wall")&&(t.value.board.fakeWalls=X(l,o))}function he({gameItem:e,gameBoard:o,state:t}){const l=e.index;if(t.value.board.fakeWalls=[],t.value.board.fakeNodes=[],console.log("click",e),e.type==="fake-wall"&&t.value.board.walls.push(...X(l,o)),e.type==="player-node"){let{x:n,y:a}=F(l,o);if(a+=1,we({x:n,y:a},t)!==t.value.activePlayer)return;t.value.board.fakeNodes=[{x:n-1,y:a},{x:n+1,y:a},{x:n,y:a-1},{x:n,y:a+1}]}if(e.type==="fake-node"){let{x:n,y:a}=F(l,o);a+=1;const c=t.value.activePlayer==="player1"?t.value.player1:t.value.player2;c.position={x:n,y:a},t.value.activePlayer=t.value.activePlayer==="player1"?"player2":"player1"}}function we(e,o){return e.x===o.value.player1.position.x&&e.y===o.value.player1.position.y?"player1":"player2"}function F(e,o){const t=Math.ceil((e%o.value.fullGameWidth+1)/2),l=Math.ceil(e/o.value.fullGameWidth)+1,n=Math.ceil(l/2)-1;return{x:t,y:n}}function X(e,o){const{x:t,y:l}=F(e,o);return Math.ceil(e/o.value.fullGameWidth)%2===0?[{type:"horizontal",topNode1:{x:t,y:l},topNode2:{x:t+1,y:l},bottomNode1:{x:t,y:l+1},bottomNode2:{x:t+1,y:l+1}}]:[{type:"vertical",leftNode1:{x:t,y:l},leftNode2:{x:t,y:l+1},rightNode1:{x:t+1,y:l},rightNode2:{x:t+1,y:l+1}}]}function G(e,o){let t=0,l=0,n=0;if(e.type==="horizontal"){const{x:a,y:c}=M(e.topNode1),{x:m,y:u}=M(e.topNode2);t=w({x:a,y:c+1},o),l=w({x:m,y:u+1},o);const{min:d}=W(a,m);n=w({x:d+1,y:u+1},o)}else if(e.type==="vertical"){const{x:a,y:c}=M(e.leftNode1),{x:m,y:u}=M(e.leftNode2);t=w({x:a+1,y:c},o),l=w({x:m+1,y:u},o);const{min:d}=W(c,u);n=w({x:m+1,y:d+1},o)}return[{type:"wall",index:t,data:e},{type:"wall",index:l,data:e},{type:"wall",index:n,data:e}]}const be={class:"board"},Ie=k({__name:"DefaultBoard",setup(e){const o=V();return(t,l)=>(r(),_("div",be,[(r(!0),_(q,null,Q(i(o).gameBoard.value.items,n=>(r(),h(_e,{cell:n,onHover:a=>i(o).actions.hover(n),onClick:a=>i(o).actions.click(n)},null,8,["cell","onHover","onClick"]))),256))]))}});const Me=I(Ie,[["__scopeId","data-v-6acc3688"]]),Ce={class:"player1"},Be={class:"mt-10"},Pe={key:0,class:"mt-10"},Fe={class:"player2"},He={class:"mt-10"},ze={key:0,class:"mt-10"},We={class:"back"},Ge=k({__name:"Header",props:{name:null},setup(e){const o=e,t=R(),l=D(),{t:n}=L(),a=V(),c=b(!0),m=b(!1),u=b(30),d=b(30),N=P(()=>u.value>0?`${u.value} сек`:"0 сек"),s=P(()=>d.value>0?`${d.value} сек`:"0 сек"),p=()=>{const $=setInterval(()=>{u.value>0?u.value--:(clearInterval($),d.value=30,C(),c.value=!1,m.value=!0)},1e3)},C=()=>{const $=setInterval(()=>{d.value>0?d.value--:(clearInterval($),u.value=30,p(),c.value=!0,m.value=!1)},1e3)};return p(),J(()=>{l.setNewName(o.name)}),($,g)=>(r(),_("div",null,[y("div",Ce,[y("p",null,f(o.name.split("+")[0])+f(i(a).state.value.player1.walls),1),y("p",Be,f(i(n)("intro.walls"))+": "+f(i(a).state.value.player1.walls),1),i(c)?(r(),_("p",Pe,f(i(n)("intro.time"))+": "+f(i(N)),1)):x("",!0)]),y("div",Fe,[y("p",null,f(o.name.split("+")[1]),1),y("p",He,f(i(n)("intro.walls"))+": "+f(i(a).state.value.player2.walls),1),i(m)?(r(),_("p",ze,f(i(n)("intro.time"))+": "+f(i(s)),1)):x("",!0)]),y("div",We,[y("button",{m:"3 t6","text-sm":"",btn:"",onClick:g[0]||(g[0]=v=>i(t).back())},f(i(n)("button.back")),1),y("button",{m:"3 t6","text-sm":"",btn:"",onClick:g[1]||(g[1]=(...v)=>$.startTimer&&$.startTimer(...v))}," s ")])]))}});const Ee={class:"flex flex-col items-center"},Se=y("h1",null,"Game",-1),Je=k({__name:"[name]",props:{name:null},setup(e){const o=e,t=D();return J(()=>{t.setNewName(o.name)}),(l,n)=>(r(),_("div",Ee,[H(Ge,{name:o.name},null,8,["name"]),Se,H(Me)]))}});export{Je as default};
